<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>行情</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
  <meta http-equiv="X-UA-Compitable" content="IE=edge">
  <link rel="stylesheet" href="../css/common.css">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/media.css">
</head>
<body>
<div class="gfc-box market-box">
  <!--<div class="container-box">-->
    <!--title-->
    <div class="header">
      <div class="header-c">
        <a class="left" href=""></a>
        <div>
          <p>0.3JVS2V<span><br>403011</span></p>
        </div>
        <a class="right" href=""></a>
      </div>
      <a class="mark" href=""></a>
    </div>
    <!--content-->
    <div class="market-text">
      <div class="price">
        <ul>
          <li class="-gfc-red"><span class="rising">3,380.00</span></li>
          <li class="-gfc-red">
            <span>+111.00</span>
            <span class="span1">+5.06%</span>
          </li>
        </ul>
        <ul>
          <li>昨收<span class="num-text">3380.00</span></li>
          <li>最高<span class="-gfc-red">3,380.00</span></li>
          <li>今开<span>3380.00</span></li>
          <li>最低<span class="gfc-green">0.00</span></li>
        </ul>
      </div>
      <div class="chart">
        <ul class="chart-tab">
          <li>分时图</li>
          <li>K线图</li>
        </ul>
        <!--content-->
        <div class="chart-box">
        <!--<div id="container" style="height: 400px; min-width: 310px;max-width:800px;margin: 0 auto;"></div>-->
        </div>
        <ul class="chart-UpDown">
          <li>涨停<span class=-gfc-red>3,380.00</span></li>
          <li>跌停<span class=gfc-green>3,380.00</span></li>
        </ul>
        <p class="note-HuNan">*以上数据来自湖南文交所钻石交易中心</p>
      </div>
      <div>
        <p>持仓</p>
        <div class="house">
          <ul>
            <li><span>商品品名</span><span>3380.00</span></li>
            <li><span>商品代码</span><span>3,380.00</span></li>
            <li><span>商品数量</span><span>3</span></li>
            <li><span>可卖数量</span><span>2</span></li>
            <li><span>成本价格</span><span>3,380.00</span></li>
            <li><span>市场价格</span><span>3,380.00</span></li>
            <li><span>当前市值</span><span>3,380.00</span></li>
            <li><span>浮动盈亏</span><span class="-gfc-red">+380.00</span></li>
          </ul>
          <div class="line"></div>
          <span class="cancel -gfc-sell txt-white">卖出</span>
        </div>
        <div class="no-data">暂无持仓</div>
      </div>
      <div>
        <p>做空</p>
        <div class="house">
          <ul>
            <li><span>商品品名</span><span>3,380.00</span></li>
            <li><span>商品代码</span><span>3,380.00</span></li>
            <li><span>做空价格</span><span>3,380.00</span></li>
            <li><span>现价</span><span>3,380.00</span></li>
            <li><span>做空数量</span><span>3,380.00</span></li>
            <li><span>浮动盈亏</span><span class="gfc-green">-380.00</span></li>
          </ul>
          <div class="line"></div>
          <span class="cancel -gfc-buy txt-white">平仓</span>
        </div>
        <div class="no-data">暂无做空</div>
      </div>
      <div>
        <p>挂单</p>
        <div class="bill bill-sell">
          <ul>
            <li><span>商品品名</span><span>0.3JVS2V2w</span></li>
            <li><span>商品代码</span><span>3,380.00</span></li>
            <li><span>挂单状态</span><span>已报</span></li>
            <li><span>挂单方向</span><span class="gfc-sell">卖出</span></li>
            <li><span>挂单价格</span><span>3,380.00</span></li>
            <li><span>挂单数量</span><span>3,380.00</span></li>
          </ul>
          <div class="line"></div>
          <span class="cancel -gfc-cancel txt-cancel">撤销</span>
        </div>
        <div class="bill bill-buy">
          <ul>
            <li><span>商品品名</span><span>3,380.00</span></li>
            <li><span>商品代码</span><span>3,380.00</span></li>
            <li><span>挂单状态</span><span>已报</span></li>
            <li><span>挂单方向</span><span class="gfc-sell gfc-buy">买入</span></li>
            <li><span>挂单价格</span><span>3,380.00</span></li>
            <li><span>挂单数量</span><span>3,380.00</span></li>
          </ul>
          <div class="line"></div>
          <span class="cancel -gfc-cancel txt-cancel">撤销</span>
        </div>
        <div class="bill bill-buy">
          <ul>
            <li><span>商品品名</span><span>3,380.00</span></li>
            <li><span>商品代码</span><span>3,380.00</span></li>
            <li><span>挂单状态</span><span>已报</span></li>
            <li><span>挂单方向</span><span class="gfc-sell gfc-buy">平仓</span></li>
            <li><span>挂单价格</span><span>3,380.00</span></li>
            <li><span>挂单数量</span><span>3,380.00</span></li>
          </ul>
          <div class="line"></div>
          <span class="cancel -gfc-cancel txt-cancel">撤销</span>
        </div>
        <div class="bill bill-buy">
          <ul>
            <li><span>商品品名</span><span>3,380.00</span></li>
            <li><span>商品代码</span><span>3,380.00</span></li>
            <li><span>挂单状态</span><span>已报</span></li>
            <li><span>挂单方向</span><span class="gfc-sell">做空</span></li>
            <li><span>挂单价格</span><span>3,380.00</span></li>
            <li><span>挂单数量</span><span>3,380.00</span></li>
          </ul>
          <div class="line"></div>
          <span class="cancel -gfc-cancel txt-cancel">撤销</span>
        </div>
        <div class="no-data">暂无挂单</div>
      </div>

    </div>
    <div class="btn-box">
      <div class="btn">
        <a href="buy.html"><span class="-gfc-buy">买入</span></a>
        <a href="sell.html"><span class="-gfc-cancel">做空</span></a>
      </div>
    </div>

  <!--</div>-->
</div>
<script type="text/javascript" src="http://cdn.hcharts.cn/jquery/jquery-1.8.3.min.js"></script>
<script src="https://code.highcharts.com/stock/highstock.js"></script>
<script src="../js/base.js"></script>
<script type="text/javascript">
  /*选项卡切换效果*/
  $('.chart-tab li').on('click',function(){
    $(this).attr('id','tab-border').siblings().removeAttr('id');
  })

  $(function(){

    //模拟当日数据
    var demoData = dataTestOut();
    // console.log(demoData)
    // console.log(demoData[demoData.length-1][0])

    // 生成模拟数据函数
    function dataTestOut(){
      var dataTest = [];
      var dataBranch1 = [];

      var a = 300;
      var b = 1489023000000;
      var c = 300
      for(var i=0;i<330;i++){
        b = b + 60000;
        if (i<=100){
          var randomNum = Math.random();
          dataBranch1.push( b )
          dataBranch1.push( a + Math.random() - Math.random() )
        }else {
          var randomNum = Math.random();
          dataBranch1.push( b )
          dataBranch1.push( null )
        }
        dataTest.push(dataBranch1)
        dataBranch1 = [];
      }
      console.log(dataTest)

      return dataTest
    }
    var todayDate = demoData[0];
    var day = Highcharts.dateFormat('%Y/%m/%d', todayDate),
      breaks = [{
        from: new Date(day + ' 11:30').getTime(),
        to: new Date(day + ' 13:00').getTime(),
        breakSize: 0 * 60
      }]

    Highcharts.setOptions({
      global: {
        timezoneOffset: -8*60
      }
    });


    var mychart = Highcharts.stockChart('container', {
      chart : {
        events : {
          load : function () {

            var myDate = new Date();
            var day = myDate.getDay();
            var hour = myDate.getHours();
            var minute = myDate.getMinutes();
            var time = hour + ':' + minute;
            // set up the updating of the chart each second
            var series = this.series[0];

            var idx = 100;
            setInterval(function () {
              // var x = demoData[demoData.length-1][0] + 60000;
              var x = demoData[idx-1][0] + 60000;
              y = Math.random() - Math.random() + 300;
              // console.log(+x + "---" + "" +y)
              series.addPoint([x, y], true, false);
              idx++;
              // console.log(demoData)
              mychart.redraw();
            }, 1000);
          }
        }
      },
      rangeSelector: {
        enabled: false  //隐藏左上角范围选择器
      },
      scrollbar: {
        enabled: false  //隐藏滚动条
      },
      navigation: {
        buttonOptions: {
          enabled: false 	//隐藏顶部导航条
        }
      },
      navigator:{
        enabled:false    //隐藏底部范围选择
      },
      credits: {
        enabled: false //隐藏highchart.com字样
      },
      xAxis: {
        crosshair:{     //鼠标经过出现十字线
          dashStyle: 'dash',   //十字线样式
          color: '#999',      //十字线颜色
          label:{
            enabled: true,
            padding:8,
            formatter:function(e){
              return  Highcharts.dateFormat("%H:%M", e);;
            },
            borderWidth:1,
            backgroundColor:"#999",
            style:{"color":"#fff"}
          }
        },
        min: 1489023000000,
        max: 1489042800000,
        type: 'datetime',
        labels: {
          formatter: function () {
            console.log(1489023019560-148904280000)
            if (this.value === 1489030200000) {
              // 1489023000000.0   1489030200000.0   1489042800000
              return '11:30/13:00';
            }
            return  Highcharts.dateFormat("%H:%M", this.value);
          },
        },
        tickPositioner: function() {
          return [1489023000000,1489030200000,1489042800000]
        },

      },
      yAxis: [{
        title: {
          text: '' // 左侧y轴名字
        },
        tickInterval: 3,	//刻度比例
        max:310, 	// 定义Y轴 最大值
        min:292, 	// 定义最小值
        crosshair:{     //鼠标经过出现十字线
          dashStyle: 'dash',   //十字线样式
          color: '#999',      //十字线颜色
          label:{
            enabled: true,
            padding:8,
            formatter:function(e){
              // return e.toFixed(2)
              // return '<span style="color: #fff;float:right">' + e.toFixed(2) + '</span>'

              if(e > 300) {
                return '<span style="color: red;float:right">' + e.toFixed(2) + '</span>' + '  ' + '<span style="color:red;">' + (Math.floor( (e-300)/e * 1000) / 100).toFixed(2) + '% </span>'
              }else if(e < 300) {
                return '<span style="color: green;float:right">' + e.toFixed(2) + '</span>' + '  ' + '<span style="color:green;">' + (Math.floor( (e-300)/e * 1000) / 100).toFixed(2) + '% </span>'
              }else if(e = 300) {
                return '<span style="color: #fff;float:right">' + e.toFixed(2) + '</span>' + '  ' + '<span style="color:#fff;">' + (Math.floor( (e-300)/e * 1000) / 100).toFixed(2) + '% </span>'
              }
            },
            borderWidth:1,
            backgroundColor:"#999",	// 背景色
            style:{"color":"#fff"}	//字体颜色
          }
        },
        opposite: false,
        labels: {
          formatter: function () {
            var a = ( this.value - 300 ) / this.value
            if(this.value > 300) {
              return '<span style="color: red">' + this.value + '</span>';
            }else if(this.value < 300) {
              return '<span style="color: green">' + this.value + '</span>';
            }else if(this.value = 300) {
              return '<span style="color: gray">' + this.value + '</span>';
            }
          }
        },

      }, {
        title: {
          text: ''   	//右侧Y轴名字
        },
        // data:demoData,
        opposite: true,
        gridLineWidth: 0,
        tickInterval: 3,	//刻度比例
        max:310, 	// 定义Y轴 最大值
        min:292, 	// 定义最小值
        // tickPositions: [260, 280, 300, 320,340,360],
        crosshair:{     //鼠标经过出现十字线
          dashStyle: 'dash',   //十字线样式
          color: '#999',      //十字线颜色
          label:{
            enabled: true,
            padding:8,
            formatter: function(e){
              // return e.toFixed(2);
              return '<span style="color: #fff;float:right">' + e.toFixed(2) + '</span>' + '<br>' + '<span>' + e + '</span>'
            },
            borderWidth:1,
            backgroundColor:"#999",	// 背景色
            style:{"color":"#fff"}	//字体颜色
          }
        },
        labels: {
          formatter: function () {
            var a = ( this.value - 300 ) / this.value
            if(this.value > 300) {
              return '<span style="color: red">' + (Math.floor(a * 1000) / 100).toFixed(2)  + '% </span>';
            }else if(this.value < 300) {
              return '<span style="color: green">' + (Math.floor(a * 1000) / 100).toFixed(2) + '% </span>';
            }else if(this.value = 300) {
              return '<span style="color: gray">' + (Math.floor(a * 1000) / 100).toFixed(2) + '% </span>';
            }
          }

        }
      }],

      series: [{
        name: 'GOOGL',
        data: demoData,
        yAxis: 0,
        marker: {
          radius:0
        }
      }],
      tooltip: {
        shared: true,
        useHTML: false,
        shadow: true,
        valueDecimals: 2,
        formatter: function () {
          var e, t, z ,o = this;
          return $.each(this.points, function () {
            var n = this.point.index;
            e = Highcharts.dateFormat("%H:%M", this.x),
              t = "当前价:" + Highcharts.numberFormat(o.y,2),
              z = "成交价：" + Highcharts.numberFormat(o.y,3)
          }),
          "时间："+e + "  " + t + " " + z
        }
      }
    });
  })

  $(function(){
    setInterval(function(){
      var myDate = new Date();
      // console.log(myDate)
    }, 500)
  })

</script>


</body>
</html>
